import{_ as s,c as a,a as e,o as t}from"./app-Dqa0694n.js";const i={};function p(l,n){return t(),a("div",null,n[0]||(n[0]=[e(`<h1 id="rate-limiting" tabindex="-1"><a class="header-anchor" href="#rate-limiting"><span>Rate limiting</span></a></h1><p>L&#39;utilisation de l&#39;API Sirene est limitée à 30 requêtes par minute. Au-delà de ce seuil, l&#39;API renvoie une erreur <code>HTTP 429 - Too Many Requests</code>.</p><p>Cette librairie gère automatiquement cette limitation en suspendant temporairement l&#39;exécution du programme, afin d&#39;attendre la réinitialisation du quota pour ensuite reprendre les appels.</p><h2 id="desactiver-rate-limit" tabindex="-1"><a class="header-anchor" href="#desactiver-rate-limit"><span>Désactiver rate limit</span></a></h2><p>Cependant, cette suspension - pouvant durer plusieurs secondes - peut s&#39;avérer contraignante dans certains contextes.</p><p>Il est donc possible de désactiver cette gestion automatique du <em>rate limiting</em> en passant <code>false</code> en second paramètre du constructeur <code>Sirene</code>.</p><p>Vous devrez alors intercepter manuellement les exceptions liées aux erreurs de quota (<code>HTTP 429</code>).</p><p>Exemple:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code><span class="line"><span class="token keyword">use</span> <span class="token package">LuFiipe<span class="token punctuation">\\</span>InseeSierene<span class="token punctuation">\\</span>Exception<span class="token punctuation">\\</span>SireneException</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">use</span> <span class="token package">LuFiipe<span class="token punctuation">\\</span>InseeSierene<span class="token punctuation">\\</span>Sirene</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token variable">$sirene</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sirene</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;YOUR-API-KEY&#39;</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$sirene</span><span class="token operator">-&gt;</span><span class="token function">informations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SireneException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token operator">-&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>L&#39;exemple ci-dessus va afficher :</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">Client error: \`GET https://api.insee.fr/api-sirene/3.11/informations\` resulted in a \`429 Too Many Requests\` ../..</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,11)]))}const o=s(i,[["render",p]]),r=JSON.parse('{"path":"/rate-limiting.html","title":"Rate limiting","lang":"fr","frontmatter":{},"headers":[{"level":2,"title":"Désactiver rate limit","slug":"desactiver-rate-limit","link":"#desactiver-rate-limit","children":[]}],"git":{"updatedTime":1750409905000,"contributors":[{"name":"Luis-Filipe ANTUNES","username":"","email":"lf.antunes.dasilva@gmail.com","commits":1}],"changelog":[{"hash":"34ae70bb58865cf686cb6461a22bc23d95033548","time":1750409905000,"email":"lf.antunes.dasilva@gmail.com","author":"Luis-Filipe ANTUNES","message":"Initial commit"}]},"filePathRelative":"rate-limiting.md"}');export{o as comp,r as data};
